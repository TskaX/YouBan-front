import{b as k,S as V,d as T,a9 as C,ai as Q,B as g,t as a,Q as r,v as u,m as n,z as B,q as i,y as c,ae as x,ad as b,k as w,C as v,ah as U,bi as $,af as P,ag as z}from"./index.f9e4126b.js";import{b as N,d as h}from"./QTable.6ea0b7e9.js";import{Q as p,a as m}from"./QTd.090e784f.js";import{Q as A}from"./QForm.c8ed59c7.js";import{Q as I}from"./QPagination.c3893f13.js";import"./selection.bf6719bc.js";import"./QChip.40f28c3a.js";import"./format.3e32b8d9.js";const E={id:"question-manage"},L={class:"q-pa-md none-reply"},j={class:"row"},G={class:"col-10"},H={class:"col-2 confirm-btn"},J={class:"q-pa-md done-reply"},K={class:"text-left"},le={__name:"QuestionManagePage",setup(O){const d=k(""),s=V([]),_=V([]),S=o=>{const t=document.querySelector(".none-reply"),e=document.querySelector(".done-reply");o===0?(t.style.cssText="display: none",e.style.cssText="display: block"):(t.style.cssText="display: block",e.style.cssText="display: none")},R=async o=>{const t=s.findIndex(e=>e._id===o);s[t].reply=1;try{const{data:e}=await C.post("/questions/replyContent/"+s[t]._id,{replyContent:s[t].replyContent,reply:s[t].reply});s.splice(t,1),_.unshift(e.result),Q.fire({icon:"success",title:"\u6210\u529F",text:"\u56DE\u8986\u6210\u529F"})}catch{Q.fire({icon:"error",title:"\u5931\u6557",text:"\u56DE\u8986\u5931\u6557"})}},M=o=>{const t=s.findIndex(e=>e._id===o);s[t].replyContent=""},q=V([{name:"member_name",label:"\u6703\u54E1\u540D\u5B57",align:"left",field:o=>o.u_id.account},{name:"title",label:"\u4E3B\u65E8",align:"left",field:o=>o.title},{name:"content",label:"\u5167\u5BB9",align:"left",field:o=>o.content},{name:"time",label:"\u806F\u7D61\u6642\u9593",align:"left",field:o=>o.time},{name:"phone",label:"\u96FB\u8A71",align:"left",field:o=>"0"+o.u_id.phone}]),f=k({sortBy:"name",descending:!1,page:1,rowsPerPage:10}),D=T(()=>Math.ceil(s.length/f.value.rowsPerPage)),y=k({sortBy:"name",descending:!1,page:1,rowsPerPage:10}),F=T(()=>Math.ceil(_.length/y.value.rowsPerPage));return(async()=>{var o,t;try{const{data:e}=await C.get("/questions/none"),{data:l}=await C.get("/questions/done");e.result.reverse(),l.result.reverse(),s.push(...e.result),_.push(...l.result),console.log(s)}catch(e){Q.fire({icon:"error",title:"\u5931\u6557",text:((t=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:t.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(o,t)=>(i(),g("div",E,[a(r,{class:"today add",label:"\u5C1A\u672A\u56DE\u8986",onClick:t[0]||(t[0]=e=>S(1))}),a(r,{class:"done add",label:"\u5DF2\u56DE\u8986",onClick:t[1]||(t[1]=e=>S(0))}),u("div",L,[a(N,{title:"\u554F\u984C\u7BA1\u7406 - \u5C1A\u672A\u56DE\u8986",rows:s,columns:q,pagination:f.value,"onUpdate:pagination":t[3]||(t[3]=e=>f.value=e),"hide-pagination":"",filter:d.value,"row-key":"_id"},{header:n(e=>[a(p,{props:e},{default:n(()=>[a(h,{"auto-width":"",class:"text-left"},{default:n(()=>[c("\u56DE\u8986\u6309\u9215")]),_:1}),(i(!0),g(x,null,b(e.cols,l=>(i(),w(h,{key:l.name,props:e},{default:n(()=>[c(v(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(e=>[a(p,{props:e},{default:n(()=>[a(m,{"auto-width":""},{default:n(()=>[a(r,{size:"sm",color:"accent",round:"",dense:"",onClick:l=>e.expand=!e.expand,icon:e.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024),(i(!0),g(x,null,b(e.cols,l=>(i(),w(m,{key:l.name,props:e},{default:n(()=>[c(v(l.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),U(a(p,{props:e},{default:n(()=>[a(m,{colspan:"100%"},{default:n(()=>[a(A,{onSubmit:l=>R(e.row._id),onReset:l=>M(e.row._id)},{default:n(()=>[u("div",j,[u("div",G,[a(P,{type:"text",modelValue:e.row.replyContent,"onUpdate:modelValue":l=>e.row.replyContent=l,label:"\u56DE\u8986"},null,8,["modelValue","onUpdate:modelValue"])]),u("div",H,[a(r,{type:"submit",label:"\u78BA\u8A8D\u56DE\u8986"}),a(r,{type:"reset",label:"\u53D6\u6D88\u56DE\u8986",onClick:l=>e.expand=!1},null,8,["onClick"])])])]),_:2},1032,["onSubmit","onReset"])]),_:2},1024)]),_:2},1032,["props"]),[[$,e.expand]])]),"top-right":n(()=>[a(P,{outlined:"",dense:"",debounce:"300",modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e),placeholder:"Search"},{append:n(()=>[a(z,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","pagination","filter"]),a(I,{modelValue:f.value.page,"onUpdate:modelValue":t[4]||(t[4]=e=>f.value.page=e),color:"grey-8",max:B(D),size:"sm"},null,8,["modelValue","max"])]),u("div",J,[a(N,{title:"\u554F\u984C\u7BA1\u7406 - \u5DF2\u56DE\u8986",rows:_,columns:q,pagination:y.value,"onUpdate:pagination":t[6]||(t[6]=e=>y.value=e),"hide-pagination":"",filter:d.value,"row-key":"_id"},{header:n(e=>[a(p,{props:e},{default:n(()=>[a(h,{"auto-width":"",class:"text-left"},{default:n(()=>[c("\u56DE\u8986\u5167\u5BB9")]),_:1}),(i(!0),g(x,null,b(e.cols,l=>(i(),w(h,{key:l.name,props:e},{default:n(()=>[c(v(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(e=>[a(p,{props:e},{default:n(()=>[a(m,{"auto-width":""},{default:n(()=>[a(r,{size:"sm",color:"accent",round:"",dense:"",onClick:l=>e.expand=!e.expand,icon:e.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024),(i(!0),g(x,null,b(e.cols,l=>(i(),w(m,{key:l.name,props:e},{default:n(()=>[c(v(l.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),U(a(p,{props:e},{default:n(()=>[a(m,{colspan:"100%"},{default:n(()=>[u("div",K,v(e.row.replyContent),1)]),_:2},1024)]),_:2},1032,["props"]),[[$,e.expand]])]),"top-right":n(()=>[a(P,{outlined:"",dense:"",debounce:"300",modelValue:d.value,"onUpdate:modelValue":t[5]||(t[5]=e=>d.value=e),placeholder:"Search"},{append:n(()=>[a(z,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","pagination","filter"]),a(I,{modelValue:y.value.page,"onUpdate:modelValue":t[7]||(t[7]=e=>y.value.page=e),color:"grey-8",max:B(F),size:"sm"},null,8,["modelValue","max"])])]))}};export{le as default};
