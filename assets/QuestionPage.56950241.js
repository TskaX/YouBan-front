import{S as y,b as k,d as F,a9 as C,ai as V,B as w,v as r,t as l,m as a,z as I,a2 as M,q as u,Q as c,y as i,ae as B,ad as P,k as b,C as p,D as R,ah as S,bi as A,af as f,ag as E,ac as L,ab as h}from"./index.f9e4126b.js";import{b as $,d as Q}from"./QTable.6ea0b7e9.js";import{Q as x,a as g}from"./QTd.090e784f.js";import{Q as j}from"./QPagination.c3893f13.js";import{Q as G}from"./QForm.c8ed59c7.js";import{C as H}from"./ClosePopup.98bce5ba.js";import"./selection.bf6719bc.js";import"./QChip.40f28c3a.js";import"./format.3e32b8d9.js";const J={id:"question"},K={class:"q-pa-md"},O={class:"text-left"},W=r("div",null,"\u554F\u984C\u767C\u554F",-1),X={class:"row"},Y={class:"col-5"},Z=r("div",{class:"col-2"},null,-1),ee={class:"col-5"},te={class:"col-12"},ce={__name:"QuestionPage",setup(le){const _={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"}},s=y({title:"",time:"",content:"",dialog:!1}),U=()=>{s.title="",s.time="",s.content="",s.dialog=!0},D=async()=>{try{const{data:t}=await C.post("/questions",s);n.unshift(t.result),console.log(n),q(),V.fire({icon:"success",title:"\u6210\u529F",text:"\u767C\u554F\u6210\u529F\u7B49\u5F85\u56DE\u5FA9"})}catch{V.fire({icon:"error",title:"\u6210\u529F",text:"\u672A\u77E5\u554F\u984C\u767C\u751F\uFF0C\u8ACB\u806F\u7D61\u5BA2\u670D"})}s.dialog=!1},v=k(""),n=y([]),N=t=>t==="\u5DF2\u56DE\u8986",q=()=>{for(let t=0;t<=n.length-1;t++)n[t].reply===0||n[t].reply==="\u5C1A\u672A\u56DE\u8986"?n[t].reply="\u5C1A\u672A\u56DE\u8986":n[t].reply="\u5DF2\u56DE\u8986"},T=y([{name:"title",label:"\u4E3B\u65E8",align:"left",field:t=>t.title},{name:"time",label:"\u806F\u7D61\u6642\u9593",align:"left",field:t=>t.time},{name:"content",label:"\u5167\u5BB9",align:"left",field:t=>t.content}]),m=k({sortBy:"name",descending:!1,page:1,rowsPerPage:5}),z=F(()=>Math.ceil(n.length/m.value.rowsPerPage));return(async()=>{var t,o;try{const{data:e}=await C.get("/questions/all");e.result.reverse(),n.push(...e.result),q()}catch(e){V.fire({icon:"error",title:"\u5931\u6557",text:((o=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:o.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(t,o)=>(u(),w("div",J,[r("div",K,[l(c,{label:"\u65B0\u589E\u554F\u984C",onClick:U,class:"add"}),l($,{title:"\u500B\u4EBA\u767C\u554F",rows:n,columns:T,pagination:m.value,"onUpdate:pagination":o[1]||(o[1]=e=>m.value=e),"hide-pagination":"",filter:v.value,"row-key":"_id"},{header:a(e=>[l(x,{props:e},{default:a(()=>[l(Q,{"auto-width":"",class:"text-left"},{default:a(()=>[i("\u56DE\u8986\u60C5\u6CC1")]),_:1}),(u(!0),w(B,null,P(e.cols,d=>(u(),b(Q,{key:d.name,props:e},{default:a(()=>[i(p(d.label),1)]),_:2},1032,["props"]))),128)),l(Q,{"auto-width":"",class:"text-left"},{default:a(()=>[i("\u67E5\u770B\u56DE\u8986")]),_:1})]),_:2},1032,["props"])]),body:a(e=>[l(x,{props:e},{default:a(()=>[l(g,null,{default:a(()=>[i(p(e.row.reply),1)]),_:2},1024),(u(!0),w(B,null,P(e.cols,d=>(u(),b(g,{key:d.name,props:e},{default:a(()=>[i(p(d.value),1)]),_:2},1032,["props"]))),128)),l(g,{"auto-width":""},{default:a(()=>[N(e.row.reply)?(u(),b(c,{key:0,size:"sm",color:"accent",round:"",dense:"",onClick:d=>e.expand=!e.expand,icon:e.expand?"remove":"add"},null,8,["onClick","icon"])):R("",!0)]),_:2},1024)]),_:2},1032,["props"]),S(l(x,{props:e},{default:a(()=>[l(g,{colspan:"100%"},{default:a(()=>[r("div",O,p(e.row.replyContent),1)]),_:2},1024)]),_:2},1032,["props"]),[[A,e.expand]])]),"top-right":a(()=>[l(f,{outlined:"",dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=e=>v.value=e),placeholder:"Search"},{append:a(()=>[l(E,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","pagination","filter"]),l(j,{modelValue:m.value.page,"onUpdate:modelValue":o[2]||(o[2]=e=>m.value.page=e),color:"grey-8",max:I(z),size:"sm"},null,8,["modelValue","max"])]),l(M,{modelValue:s.dialog,"onUpdate:modelValue":o[6]||(o[6]=e=>s.dialog=e),class:"question-dialog"},{default:a(()=>[l(L,null,{default:a(()=>[l(G,{onSubmit:D,onReset:t.reset},{default:a(()=>[l(h,{class:"row question-title"},{default:a(()=>[W]),_:1}),l(h,{class:"question-main"},{default:a(()=>[r("div",X,[r("div",Y,[i("\u4E3B\u65E8 "),l(f,{outlined:"",modelValue:s.title,"onUpdate:modelValue":o[3]||(o[3]=e=>s.title=e),rules:[_.required]},null,8,["modelValue","rules"])]),Z,r("div",ee,[i("\u65B9\u4FBF\u806F\u7D61\u6642\u9593 "),l(f,{outlined:"",modelValue:s.time,"onUpdate:modelValue":o[4]||(o[4]=e=>s.time=e),rules:[_.required]},null,8,["modelValue","rules"])]),r("div",te,[i("\u63CF\u8FF0\u554F\u984C "),l(f,{outlined:"",type:"textarea",modelValue:s.content,"onUpdate:modelValue":o[5]||(o[5]=e=>s.content=e),rules:[_.required]},null,8,["modelValue","rules"])])])]),_:1}),l(h,{class:"question-btn"},{default:a(()=>[l(c,{label:"\u767C\u9001",type:"submit"}),S(l(c,{label:"\u53D6\u6D88"},null,512),[[H]])]),_:1})]),_:1},8,["onReset"])]),_:1})]),_:1},8,["modelValue"])]))}};export{ce as default};
